FROM viezel/php:8.0

## More available resources for php-fpm
RUN sed -i "s/pm.max_children = .*/pm.max_children = 20/" /etc/php/8.0/fpm/pool.d/www.conf \
    && sed -i "s/pm.start_servers = .*/pm.start_servers = 10/" /etc/php/8.0/fpm/pool.d/www.conf \
    && sed -i "s/pm.min_spare_servers = .*/pm.min_spare_servers = 5/" /etc/php/8.0/fpm/pool.d/www.conf \
    && sed -i "s/pm.max_spare_servers = .*/pm.max_spare_servers = 10/" /etc/php/8.0/fpm/pool.d/www.conf

# Disable opcache for Development
RUN sed -i -e "s/opcache.enable=1/opcache.enable=0/" /etc/php/8.0/fpm/php.ini

COPY startup.sh /usr/bin/startup

ENTRYPOINT [ "bash" ]
CMD ["/usr/bin/startup"]

